---
name: 日志错误统计
overview: 实现一个 Python 程序从 `input/input.json` 读取日志，过滤 ERROR 并统计服务次数，输出到 `output/output.json`，同时兼容 stdin。
todos:
  - id: inspect-structure
    content: 检查项目结构与现有入口脚本
    status: completed
  - id: implement-logic
    content: 实现读取、过滤统计与排序输出逻辑
    status: completed
    dependencies:
      - inspect-structure
  - id: verify-output
    content: 用示例数据快速验证输出结构与排序
    status: completed
    dependencies:
      - implement-logic
---

# 日志错误统计实现计划

## 目标

- 如果没有传参数就读取 `input下的所有json文件` （若传参数则读取 stdin）
- 过滤 `level` 为 "ERROR" 的日志并按 `service` 统计次数
- 将统计结果按键名 A-Z 排序后输出到 `output/，`文件名和输入相同并增加-output后缀

## 修改范围

- 新增或修改主脚本文件（待确认现有项目结构后选择路径）
- 读取输入：`input/` / stdin
- 输出结果：`output/`

## 实施步骤

- 检查仓库结构与现有入口脚本，确定最佳脚本位置与命名
- 实现读取逻辑：优先文件，文件缺失或为空则读取 stdin
- 实现统计逻辑：过滤 ERROR，按 `service` 计数并排序
- 实现输出逻辑：确保 `output/` 目录存在并写入 JSON
- 简单自测：用示例输入验证输出 JSON 结构与排序

## 可能涉及的文件

- `input/`
- `output/`
- （待确定）`main.py` 或项目已有入口文件